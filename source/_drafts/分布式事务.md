---
title: 分布式事务
categories:
  - null
date: 2023-06-05 09:13:09
tags:
---

hello world

---

[toc]

参考文章：https://zhuanlan.zhihu.com/p/461294722



# 定义

分布式事务是指

- 事务的参与者
- 支持事务的服务器
- 资源服务器
- 事务管理器

这四个在不同的机器上。

# 一些基础知识

### cap理论

> 一个被证实了的理论，是各种解决方案的基础

- c：consistency，一致性。所有客户端看到的数据都是一致的
- a：availability，可用性。某个节点出现故障，客户端依然能从别的节点找到备份数据
- p：partition tolerance，分区容错性。发生网络分区故障，整个系统依然稳定运行

cap理论：这三种特性，分布式事务**最多**只能满足其中两种

### base理论

> 一种acid的替代方法，让可用性和一致性达到微妙的平衡

根据cap理论，要想实现事务的acid特性，只能放弃可用性来保全一致性。

> todo：不知道为什么p一定要满足

于是提出base理论，在满足a、p特性的情况下，最大限度地保证c。

- **BA**：**Basically Available** ，基本可用性

  是相对CAP的“完全可用”而言的

  出故障时，允许**部分功能不可用**，或者性能下降：比如一些不那么重要的功能

- **S：Soft State**，软状态

  是相对CAP定理强一致性的“硬状态”而言的

  CAP的一致性要求数据变化**立刻**反应到其他节点。

  软状态则**允许慢一点**

- **E：Eventually Consistency**，最终一致性

  也是相对CAP定理强一致性而言的

  不需要每时每刻都保持一致性，

  只需要经过一段时间，**最终**能保证一致性就行了

### 总结

上面的理论说明，没有十全十美的方案。

具体情况具体分析，需要根据项目的需求来进行取舍。



---

# 各种解决方案

### 强一致性方案

#### 2PC-二阶段提交（Two-phaseCommit）



#### 3PC-三阶段提交





















